[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "docs/point-process.html",
    "href": "docs/point-process.html",
    "title": "The Heart as a Stochastic Machine",
    "section": "",
    "text": "Grab a coffee, settle in, and let’s talk about the human heart. But not the romanticized version you see on Valentine’s cards, nor the simple mechanical pump your high school biology teacher described. We are going to talk about the heart as a stochastic machine—a noisy, jittery, beautiful mess of probability and biology.\nIf you have ever played a rhythm game like Guitar Hero or Rock Band, you know that hitting the note perfectly on the beat is hard. You might be a little early, a little late. Now imagine the drummer isn’t a machine, but a human being who just drank three espressos and is worried about their tax return. That drummer is your heart.\nFor decades, we have treated Heart Rate Variability (HRV) like a “black box”. You put an ECG in one side, and out pops a number like SDNN or RMSSD. We treat these numbers like magical runes that tell us if we are stressed or healthy. But that is a bit like judging a movie solely by its runtime. We are missing the plot! The heart rate is a vital sign, sure, but HRV is the actual quantitative measure of cardiovascular regulation by the autonomic nervous system.\nThe standard methods—counting beats, averaging intervals, or doing Fourier transforms—often treat the heartbeat series as a continuous signal, like a temperature reading or a stock price. But here is the kicker: heartbeats aren’t continuous signals. They are point processes. They are discrete events occurring in continuous time. A standard time-series model assumes that at every millisecond, there is a value. But there isn’t a “heartbeat value” between beats; there is just silence, followed by a sudden electrical explosion.\nSo, instead of just analyzing the output (the beats), what if we built a mathematical model of the drummer itself? What if we simulated the nervous system pulling the strings? That is what we are doing today. We are going to build a “virtual heart” from scratch, using rigorous math to describe the biology.\n\n\n\nTo build our model, we first need to understand the hardware. The heart’s pacemaker is the Sinoatrial (SA) node, a small cluster of cells in the right atrium.\nThink of the SA node cell like a bucket sitting under a dripping faucet. The water represents positive ions (sodium and calcium) flowing into the cell. The bucket has a “fill line” marked at the top. When the water hits that line, the bucket tips over, dumps the water, and triggers a heartbeat (an action potential). Then, the bucket sets itself back up and starts filling again immediately.\nThis mechanism is often called “Integrate-and-Fire”. The cell integrates (accumulates) voltage until it fires.\nNow, here is where the chaos enters. The faucet isn’t dripping steadily. It is sputtering. Some milliseconds it drips fast, some milliseconds it drips slow. This is due to the stochastic nature of ion channels opening and closing—thermal noise, essentially. So, the water level in our bucket doesn’t rise in a perfect straight line. It wiggles upward. In mathematics, we call this a Gaussian Random Walk with Drift.\nIf the voltage rise is a random walk, then the time it takes to hit the threshold is a random variable. Specifically, the probability distribution of these “First Passage Times” (the time to hit the line) is known as the Inverse Gaussian distribution.\nThis is why we choose the Inverse Gaussian for our model. We aren’t just picking a bell curve because it looks nice. We are picking the distribution that physically describes how membrane potentials rise to a threshold. It is the mathematically correct description of the “leaky bucket” mechanics of your heart cells.\nLet’s visualize this. In the code below, we simulate the “bucket” (membrane potential) filling up with noisy water. Watch how the randomness in the filling process leads to variation in the time it takes to spill (the heartbeat).\n\n\nCode\nset.seed(42)\n\n# Parameters for the Random Walk\nthreshold &lt;- 10\ndrift &lt;- 0.5      # Speed of filling\nnoise_sd &lt;- 1.5   # How \"sputtering\" the faucet is\ndt &lt;- 0.1         # Time step\nmax_time &lt;- 50\n\n# Simulation containers\ntime &lt;- seq(0, max_time, by=dt)\nvoltage &lt;- numeric(length(time))\nvoltage[1] &lt;- 0\nspikes &lt;- numeric(0)\n\n# Simulate the \"Bucket\" filling\nfor(i in 2:length(time)) {\n  # Random Walk step: Previous + Drift + Noise\n  step &lt;- drift * dt + rnorm(1, 0, noise_sd * sqrt(dt))\n  voltage[i] &lt;- voltage[i-1] + step\n  \n  # Check Threshold\n  if(voltage[i] &gt;= threshold) {\n    voltage[i] &lt;- 0 # Reset (Repolarization)\n    spikes &lt;- c(spikes, time[i]) # Record the beat\n  }\n}\n\n# Plotting the physiological process\nplot(time, voltage, type='l', col=\"#0072B2\", lwd=2,\n     main=\"The Stochastic Pacemaker: Random Walk to Threshold\",\n     xlab=\"Time (ms)\", ylab=\"Membrane Potential (arbitrary units)\",\n     ylim=c(-2, 12), frame.plot=FALSE)\n\n# Draw the Threshold\nabline(h=threshold, col=\"#D55E00\", lty=2, lwd=2)\ntext(0, 10.5, \"Firing Threshold\", pos=4, col=\"#D55E00\")\n\n# Draw the Spikes (Heartbeats)\nif(length(spikes) &gt; 0) {\n  points(spikes, rep(threshold, length(spikes)), pch=8, col=\"black\", cex=2)\n  rug(spikes, col=\"black\", lwd=2)\n}\n\n\n\n\n\n\n\n\nFigure 1: The Integrate-and-Fire Mechanism. The blue line represents the membrane potential of a pacemaker cell. It drifts upward with noise (Brownian motion) until it hits the threshold (red dashed line). The moment it hits, a heartbeat occurs, and the potential resets. The time taken to hit the threshold is the R-R interval.\n\n\n\n\n\nNotice in the plot above that the time between the black stars (the heartbeats) isn’t perfectly constant. Even though the drift (the average fill rate) is constant, the noise makes some beats happen early and some late. That variation? That is the most basic form of Heart Rate Variability.\nThis leads us to a critical realization provided by Barbieri et al.: if we assume the intervals are independent, we get a “Renewal Inverse Gaussian” model. But in reality, the speed of the dripping faucet changes over time because your nervous system is turning the handle! The sympathetic system opens the faucet (faster drip), and the parasympathetic system tightens it (slower drip). This means the intervals are not independent; they depend on the history of these inputs. We need a model that accounts for this dynamic history."
  },
  {
    "objectID": "docs/point-process.html#introduction-beyond-the-black-box-of-hrv",
    "href": "docs/point-process.html#introduction-beyond-the-black-box-of-hrv",
    "title": "The Heart as a Stochastic Machine",
    "section": "",
    "text": "Grab a coffee, settle in, and let’s talk about the human heart. But not the romanticized version you see on Valentine’s cards, nor the simple mechanical pump your high school biology teacher described. We are going to talk about the heart as a stochastic machine—a noisy, jittery, beautiful mess of probability and biology.\nIf you have ever played a rhythm game like Guitar Hero or Rock Band, you know that hitting the note perfectly on the beat is hard. You might be a little early, a little late. Now imagine the drummer isn’t a machine, but a human being who just drank three espressos and is worried about their tax return. That drummer is your heart.\nFor decades, we have treated Heart Rate Variability (HRV) like a “black box”. You put an ECG in one side, and out pops a number like SDNN or RMSSD. We treat these numbers like magical runes that tell us if we are stressed or healthy. But that is a bit like judging a movie solely by its runtime. We are missing the plot! The heart rate is a vital sign, sure, but HRV is the actual quantitative measure of cardiovascular regulation by the autonomic nervous system.\nThe standard methods—counting beats, averaging intervals, or doing Fourier transforms—often treat the heartbeat series as a continuous signal, like a temperature reading or a stock price. But here is the kicker: heartbeats aren’t continuous signals. They are point processes. They are discrete events occurring in continuous time. A standard time-series model assumes that at every millisecond, there is a value. But there isn’t a “heartbeat value” between beats; there is just silence, followed by a sudden electrical explosion.\nSo, instead of just analyzing the output (the beats), what if we built a mathematical model of the drummer itself? What if we simulated the nervous system pulling the strings? That is what we are doing today. We are going to build a “virtual heart” from scratch, using rigorous math to describe the biology."
  },
  {
    "objectID": "docs/point-process.html#the-biophysics-of-a-beat-why-inverse-gaussian",
    "href": "docs/point-process.html#the-biophysics-of-a-beat-why-inverse-gaussian",
    "title": "The Heart as a Stochastic Machine",
    "section": "",
    "text": "To build our model, we first need to understand the hardware. The heart’s pacemaker is the Sinoatrial (SA) node, a small cluster of cells in the right atrium.\nThink of the SA node cell like a bucket sitting under a dripping faucet. The water represents positive ions (sodium and calcium) flowing into the cell. The bucket has a “fill line” marked at the top. When the water hits that line, the bucket tips over, dumps the water, and triggers a heartbeat (an action potential). Then, the bucket sets itself back up and starts filling again immediately.\nThis mechanism is often called “Integrate-and-Fire”. The cell integrates (accumulates) voltage until it fires.\nNow, here is where the chaos enters. The faucet isn’t dripping steadily. It is sputtering. Some milliseconds it drips fast, some milliseconds it drips slow. This is due to the stochastic nature of ion channels opening and closing—thermal noise, essentially. So, the water level in our bucket doesn’t rise in a perfect straight line. It wiggles upward. In mathematics, we call this a Gaussian Random Walk with Drift.\nIf the voltage rise is a random walk, then the time it takes to hit the threshold is a random variable. Specifically, the probability distribution of these “First Passage Times” (the time to hit the line) is known as the Inverse Gaussian distribution.\nThis is why we choose the Inverse Gaussian for our model. We aren’t just picking a bell curve because it looks nice. We are picking the distribution that physically describes how membrane potentials rise to a threshold. It is the mathematically correct description of the “leaky bucket” mechanics of your heart cells.\nLet’s visualize this. In the code below, we simulate the “bucket” (membrane potential) filling up with noisy water. Watch how the randomness in the filling process leads to variation in the time it takes to spill (the heartbeat).\n\n\nCode\nset.seed(42)\n\n# Parameters for the Random Walk\nthreshold &lt;- 10\ndrift &lt;- 0.5      # Speed of filling\nnoise_sd &lt;- 1.5   # How \"sputtering\" the faucet is\ndt &lt;- 0.1         # Time step\nmax_time &lt;- 50\n\n# Simulation containers\ntime &lt;- seq(0, max_time, by=dt)\nvoltage &lt;- numeric(length(time))\nvoltage[1] &lt;- 0\nspikes &lt;- numeric(0)\n\n# Simulate the \"Bucket\" filling\nfor(i in 2:length(time)) {\n  # Random Walk step: Previous + Drift + Noise\n  step &lt;- drift * dt + rnorm(1, 0, noise_sd * sqrt(dt))\n  voltage[i] &lt;- voltage[i-1] + step\n  \n  # Check Threshold\n  if(voltage[i] &gt;= threshold) {\n    voltage[i] &lt;- 0 # Reset (Repolarization)\n    spikes &lt;- c(spikes, time[i]) # Record the beat\n  }\n}\n\n# Plotting the physiological process\nplot(time, voltage, type='l', col=\"#0072B2\", lwd=2,\n     main=\"The Stochastic Pacemaker: Random Walk to Threshold\",\n     xlab=\"Time (ms)\", ylab=\"Membrane Potential (arbitrary units)\",\n     ylim=c(-2, 12), frame.plot=FALSE)\n\n# Draw the Threshold\nabline(h=threshold, col=\"#D55E00\", lty=2, lwd=2)\ntext(0, 10.5, \"Firing Threshold\", pos=4, col=\"#D55E00\")\n\n# Draw the Spikes (Heartbeats)\nif(length(spikes) &gt; 0) {\n  points(spikes, rep(threshold, length(spikes)), pch=8, col=\"black\", cex=2)\n  rug(spikes, col=\"black\", lwd=2)\n}\n\n\n\n\n\n\n\n\nFigure 1: The Integrate-and-Fire Mechanism. The blue line represents the membrane potential of a pacemaker cell. It drifts upward with noise (Brownian motion) until it hits the threshold (red dashed line). The moment it hits, a heartbeat occurs, and the potential resets. The time taken to hit the threshold is the R-R interval.\n\n\n\n\n\nNotice in the plot above that the time between the black stars (the heartbeats) isn’t perfectly constant. Even though the drift (the average fill rate) is constant, the noise makes some beats happen early and some late. That variation? That is the most basic form of Heart Rate Variability.\nThis leads us to a critical realization provided by Barbieri et al.: if we assume the intervals are independent, we get a “Renewal Inverse Gaussian” model. But in reality, the speed of the dripping faucet changes over time because your nervous system is turning the handle! The sympathetic system opens the faucet (faster drip), and the parasympathetic system tightens it (slower drip). This means the intervals are not independent; they depend on the history of these inputs. We need a model that accounts for this dynamic history."
  },
  {
    "objectID": "docs/point-process.html#point-processes-for-non-mathematicians",
    "href": "docs/point-process.html#point-processes-for-non-mathematicians",
    "title": "The Heart as a Stochastic Machine",
    "section": "2.1 Point Processes for Non-Mathematicians",
    "text": "2.1 Point Processes for Non-Mathematicians\nNow that we understand the hardware, let’s talk about the software. How do we mathematically describe the probability of a beat occurring right now?\nIn the world of continuous signals, you ask, “What is the value of X at time t?” In the world of events (point processes), you ask, “What is the probability that an event happens in the next split second, given everything that has happened so far?”\nThis instantaneous probability rate is called the Conditional Intensity Function, denoted as \\(\\lambda(t \\mid \\mathcal{H}_t)\\). Think of it like a “Danger Meter” or a “Hazard Rate”.\nImagine you are waiting for a bus.\n\nMinute 0-5: The probability of the bus arriving is low. \\(\\lambda(t)\\) is near zero.\nMinute 10: The scheduled arrival time is approaching. \\(\\lambda(t)\\) starts to rise.\nMinute 15: The bus is late. The probability that it arrives in the next second is getting very high because it has to arrive eventually. \\(\\lambda(t)\\) peaks.\nMinute 16 (Bus Arrives): The event happens!\nMinute 16 + 1 second: The probability of another bus arriving immediately drops to zero. You just saw one; the next one won’t be here for a while. This is the Refractory Period.\n\nStandard Poisson processes (like a Geiger counter measuring radiation) have a flat intensity. They have no memory. The bus could arrive at any second with equal probability. But the heart has a memory. It cannot fire immediately after a beat because the ion channels need to reset (repolarize).\nThe Inverse Gaussian model captures this beautifully. Its hazard rate starts at zero (refractory), rises steeply as the “bucket” fills, and then tapers off. This shape perfectly mimics the physiological recovery of the heart tissue.\nLet’s visualize this “Hazard Rate” profile. This curve represents the urgency of the heart to beat as time ticks by since the last beat.\n\n\nCode\n# Time since last spike (tau)\ntau &lt;- seq(0.01, 1.5, length.out=500)\nmu &lt;- 0.8         # Mean interval (seconds)\nlambda_scale &lt;- 20 # Shape parameter (inverse variance)\n\n# Inverse Gaussian PDF\nf_ig &lt;- sqrt(lambda_scale / (2 * pi * tau^3)) * exp(-lambda_scale * (tau - mu)^2 / (2 * mu^2 * tau))\n\n# Inverse Gaussian CDF\nz1 &lt;- sqrt(lambda_scale/tau) * (tau/mu - 1)\nz2 &lt;- -sqrt(lambda_scale/tau) * (tau/mu + 1)\nF_ig &lt;- pnorm(z1) + exp(2*lambda_scale/mu) * pnorm(z2)\n\n# Hazard Function: lambda(t) = f(t) / (1 - F(t))\n# We add a tiny epsilon to denominator to avoid division by zero\nhazard &lt;- f_ig / (1 - F_ig + 1e-10)\n\npar(mfrow=c(1,1))\nplot(tau, hazard, type='l', lwd=3, col=\"#D55E00\",\n     main=\"The Heart's 'Urgency' Function\",\n     xlab=\"Time since last beat (seconds)\",\n     ylab=\"Conditional Intensity (Spikes/sec)\", frame.plot=FALSE)\ngrid()\nabline(v=mu, lty=2, col=\"grey\")\ntext(mu, max(hazard)*0.8, \"Mean Interval\", pos=4, col=\"grey\")\n\n\n\n\n\n\n\n\nFigure 2: The ‘Urgency’ to Beat. This plot shows the Conditional Intensity (Hazard Rate) for an Inverse Gaussian process. Notice how it starts at 0 (the heart refuses to beat immediately after the last one) and rises sharply as time approaches the mean interval (0.8s). This ‘Refractory’ shape is what separates biological models from simple Poisson models."
  },
  {
    "objectID": "docs/point-process.html#the-sde-revolution-modeling-the-hidden-drivers",
    "href": "docs/point-process.html#the-sde-revolution-modeling-the-hidden-drivers",
    "title": "The Heart as a Stochastic Machine",
    "section": "2.2 The SDE Revolution: Modeling the “Hidden Drivers”",
    "text": "2.2 The SDE Revolution: Modeling the “Hidden Drivers”\nWe have our bucket (the SA node) and we have our probability curve (Inverse Gaussian). But who is turning the faucet handle? Who is changing the drift rate?\nIt is the Autonomic Nervous System (ANS). The ANS has two main branches that act like the accelerator and brake of a car:\n\nSympathetic: The accelerator. It releases norepinephrine, which opens the ion channels wider, fills the bucket faster, and raises the heart rate.\nParasympathetic (Vagal): The brake. It releases acetylcholine, which closes the channels, fills the bucket slower, and lowers the heart rate.\n\nIn the Barbieri model, these inputs are estimated beat-by-beat using a regression on the past history. It works well, but it treats the inputs as discrete steps. But your nerves don’t just switch states every heartbeat; they are continuous biological flows.\nThis is where we upgrade to Stochastic Differential Equations (SDEs). We model the sympathetic tone, let’s call it \\(s(t)\\), and the parasympathetic tone, \\(p(t)\\), as continuous variables that evolve in the background, invisible to the naked eye but driving the whole show.\nWe use the Ornstein-Uhlenbeck (OU) process to model these tones. Think of the OU process as a “Leaky Tank”.\n\nThe Input (\\(u(t)\\)): You pour water (neurotransmitters) into the tank based on external stress (exercise, math tests, scary movies).\nThe Leak (\\(-a \\cdot x(t)\\)): The tank has a hole in the bottom. If you stop pouring, the water level naturally decays back to zero. This decay rate \\(a\\) is crucial.\nThe Noise (\\(\\sigma \\cdot dW\\)): The wind is blowing over the tank, causing ripples on the surface. Biology is never perfectly smooth; there is always synaptic noise.\n\nHere is the beauty of it: biology dictates the leak size. The Parasympathetic system is fast. Acetylcholine is broken down instantly by enzymes. The tank leaks very quickly. This allows your heart rate to change in milliseconds (like when you exhale). So, \\(a_p\\) is large (fast decay). The Sympathetic system is slow. Norepinephrine works via second messengers (G-proteins). It’s like a heavy, sluggish fluid. The tank leaks slowly. So, \\(a_s\\) is small (slow decay)."
  },
  {
    "objectID": "docs/point-process.html#coupling-the-systems-sympathovagal-balance",
    "href": "docs/point-process.html#coupling-the-systems-sympathovagal-balance",
    "title": "The Heart as a Stochastic Machine",
    "section": "2.3 Coupling the Systems: Sympathovagal Balance",
    "text": "2.3 Coupling the Systems: Sympathovagal Balance\nThese two systems don’t work in isolation. They talk to each other. Physiologists call this Sympathovagal Balance, but it is often more like a wrestling match.\nThere is a phenomenon called “Accentuated Antagonism”. When your sympathetic drive is super high (like running for your life), the parasympathetic system finds it harder to act. The “accelerator” effectively jams the “brake”.\nWe model this mathematically by coupling our SDEs. The equation for the change in parasympathetic tone, \\(dp(t)\\), might look like this:\n\\[\ndp(t) = \\text{Decay} + \\text{Input} + \\text{Crosstalk}(s(t)) + \\text{Noise}\n\\]\nThe crosstalk term means the value of the other state influences how this state changes. This gives us a rich, interconnected system where the “hidden drivers” are dancing together, pushing and pulling the drift rate of our Inverse Gaussian bucket.\nLet’s visualize this dance. In the code below, we simulate these two hidden processes. Notice how the blue line (Parasympathetic) is jagged and fast, while the red line (Sympathetic) is smooth and rolling. This difference in “texture” is exactly what allows us to distinguish them mathematically just by looking at the heartbeats!\n\n\nCode\n# Parameters\ndt &lt;- 0.01\nduration &lt;- 60\nsteps &lt;- duration / dt\nt_seq &lt;- seq(0, duration, length.out = steps)\n\n# Decay rates\na_p &lt;- 2.0  # Fast Vagal\na_s &lt;- 0.2  # Slow Sympathetic\n\n# Noise levels\nsig_p &lt;- 1.0\nsig_s &lt;- 0.5\n\n# Coupling (Sympathetic inhibits Parasympathetic)\nb_ps &lt;- -0.5 \n\n# Vectors\np &lt;- numeric(steps)\ns &lt;- numeric(steps)\n\nset.seed(101)\n# Euler-Maruyama Integration\nfor(i in 1:(steps-1)) {\n  # Independent Wiener Noise\n  dw_p &lt;- rnorm(1, 0, sqrt(dt))\n  dw_s &lt;- rnorm(1, 0, sqrt(dt))\n  \n  # Update s(t) - The slow driver\n  # ds = -a_s * s + noise\n  ds &lt;- -a_s * s[i] * dt + sig_s * dw_s\n  s[i+1] &lt;- s[i] + ds\n  \n  # Update p(t) - The fast driver\n  # dp = -a_p * p + coupling * s + noise\n  # Note the coupling: High 's' pushes 'p' down\n  dp &lt;- (-a_p * p[i] + b_ps * s[i]) * dt + sig_p * dw_p\n  p[i+1] &lt;- p[i] + dp\n}\n\n# Visualization\npar(mar=c(4,4,2,2))\nplot(t_seq, p, type='l', col=\"#0072B2\", ylim=range(c(p,s)),\n     main=\"The Autonomic Dance: Coupled SDEs\",\n     xlab=\"Time (s)\", ylab=\"Normalized Activity\", frame.plot=FALSE)\nlines(t_seq, s, col=\"#D55E00\", lwd=2)\n\nlegend(\"topright\", legend=c(\"Parasympathetic (Fast)\", \"Sympathetic (Slow)\"),\n       col=c(\"#0072B2\", \"#D55E00\"), lwd=c(1, 2), bty=\"n\")\ngrid()\n\n\n\n\n\n\n\n\nFigure 3: The Hidden Drivers. This simulation shows the latent autonomic states. The blue Parasympathetic trace oscillates rapidly because of its fast decay rate (high a_p). The red Sympathetic trace is sluggish and smooth (low a_s). In our model, these two invisible lines combine to determine the drift rate of the pacemaker cell.\n\n\n\n\n\nThis framework moves us from a purely statistical description (distributions and regressions) to a mechanistic one. We aren’t just fitting a curve to data; we are simulating the biological machinery that generated the data. The “rubber band” of the SDE (mean reversion) represents enzymatic breakdown. The “noise” represents synaptic jitter. The “coupling” represents neural cross-talk.\nIn the next phases, we will see how to put this all together to generate realistic heartbeat data and, crucially, how to work backward to infer these hidden states from a patient’s ECG."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "A Continuous-Time Stochastic State-Space Framework for Heart Rate Variability",
    "section": "",
    "text": "For a deep dive into point processes models applied for modeling R-R intervals, please check this Zero-to-Hero guide!"
  },
  {
    "objectID": "index.html#the-coupled-stochastic-differential-equations",
    "href": "index.html#the-coupled-stochastic-differential-equations",
    "title": "A Continuous-Time Stochastic State-Space Framework for Heart Rate Variability",
    "section": "3.1 2.1 The Coupled Stochastic Differential Equations",
    "text": "3.1 2.1 The Coupled Stochastic Differential Equations\nThe evolution of the autonomic states is governed by a system of linear stochastic differential equations. This formulation allows for the directed coupling of the two branches, capturing phenomena such as sympathovagal balance and accentuated antagonism. The system is defined as follows:\n\\[\n\\begin{aligned}\ndp(t) &= \\left( -a_{p}p(t) + b_{ps}s(t) + c_{p}u(t) \\right) dt + \\sigma_{p}dW_{p}(t) \\\\\nds(t) &= \\left( -a_{s}s(t) + b_{sp}p(t) + c_{s}u(t) \\right) dt + \\sigma_{s}dW_{s}(t)\n\\end{aligned}\n\\]\nThe parameters \\(a_p\\) and \\(a_s\\) represent the decay rates of the parasympathetic and sympathetic responses. Physiologically, the vagal (parasympathetic) response is rapid, mediated by direct acetylcholine-gated channels, implying a large value for \\(a_p\\). The sympathetic response is slower, mediated by second-messenger systems, implying a smaller value for \\(a_s\\). The terms \\(b_{ps}\\) and \\(b_{sp}\\) quantify the cross-branch coupling, while \\(u(t)\\) represents an exogenous forcing function such as respiration or workload, scaled by sensitivity coefficients \\(c_p\\) and \\(c_s\\). The stochastic innovations \\(dW_p(t)\\) and \\(dW_s(t)\\) are increments of independent Wiener processes, introducing intrinsic biological noise into the control loop.\nWe visualize the behavior of these coupled states below. The simulation demonstrates how the two branches respond differently to the same stochastic perturbations due to their distinct time constants.\n\n\nCode\nsim_latent_sde &lt;- function(duration = 60, dt = 0.01) {\n  n_steps &lt;- duration / dt\n  times &lt;- seq(0, duration, length.out = n_steps)\n  \n  # Parameters defining the timescales\n  a_p &lt;- 2.5   # Fast vagal decay\n  a_s &lt;- 0.2   # Slow sympathetic decay\n  sigma_p &lt;- 1.0\n  sigma_s &lt;- 0.5\n  \n  # Initialization\n  p &lt;- numeric(n_steps)\n  s &lt;- numeric(n_steps)\n  \n  set.seed(42)\n  # Euler-Maruyama Integration\n  for(i in 1:(n_steps-1)) {\n    # Generate Wiener increments\n    dw_p &lt;- rnorm(1, sd = sqrt(dt))\n    dw_s &lt;- rnorm(1, sd = sqrt(dt))\n    \n    # Update equations (uncoupled for clear visualization of timescales)\n    dp &lt;- -a_p * p[i] * dt + sigma_p * dw_p\n    ds &lt;- -a_s * s[i] * dt + sigma_s * dw_s\n    \n    p[i+1] &lt;- p[i] + dp\n    s[i+1] &lt;- s[i] + ds\n  }\n\n  # Visualization\n  par(mfrow = c(2, 1), mar = c(3, 5, 2, 2))\n  plot(times, p, type = 'l', col = \"#0072B2\", lwd = 1,\n       ylab = \"Parasympathetic p(t)\", xaxt = 'n', frame.plot = FALSE,\n       main = \"Latent Stochastic Processes\")\n  grid(col = \"lightgray\")\n  \n  plot(times, s, type = 'l', col = \"#D55E00\", lwd = 2,\n       ylab = \"Sympathetic s(t)\", xlab = \"Time (s)\", frame.plot = FALSE)\n  grid(col = \"lightgray\")\n}\n\nsim_latent_sde()\n\n\n\n\n\n\n\n\nFigure 1: Trajectory of Latent Autonomic States. The blue trace (Parasympathetic) exhibits high-frequency variability due to its fast decay rate, while the red trace (Sympathetic) shows smoother, low-frequency trends. This frequency separation is intrinsic to the SDE formulation."
  },
  {
    "objectID": "index.html#the-time-varying-mean-interval",
    "href": "index.html#the-time-varying-mean-interval",
    "title": "A Continuous-Time Stochastic State-Space Framework for Heart Rate Variability",
    "section": "4.1 3.1 The Time-Varying Mean Interval",
    "text": "4.1 3.1 The Time-Varying Mean Interval\nWe define the instantaneous target heart rate \\(\\rho(t)\\) as a linear combination of the baseline pacing rate and the autonomic modulators. Consistent with physiological conventions where sympathetic activity increases rate and parasympathetic activity decreases it, we write:\n\\[\n\\rho(t) = \\rho_0 + k_{sym}s(t) - k_{par}p(t)\n\\]\nThe instantaneous mean R-R interval \\(\\mu(t)\\), which serves as the location parameter for the Inverse Gaussian density, is the reciprocal of this rate: \\(\\mu(t) = 1 / \\rho(t)\\)."
  },
  {
    "objectID": "index.html#the-conditional-intensity-function",
    "href": "index.html#the-conditional-intensity-function",
    "title": "A Continuous-Time Stochastic State-Space Framework for Heart Rate Variability",
    "section": "4.2 3.2 The Conditional Intensity Function",
    "text": "4.2 3.2 The Conditional Intensity Function\nFor point process simulation and likelihood estimation, we require the conditional intensity function \\(\\lambda(t | \\mathcal{H}_t)\\). This function is derived from the Inverse Gaussian probability density function (PDF) \\(f(t)\\) and its cumulative distribution function (CDF) \\(F(t)\\).\nThe PDF for the time \\(t\\) of the next beat, given the previous beat occurred at \\(u_k\\), is:\n\\[\nf(t \\mid u_k, \\mathbf{x}(t)) = \\left[ \\frac{\\kappa}{2\\pi(t-u_k)^3} \\right]^{1/2} \\exp \\left\\{ -\\frac{\\kappa [ (t-u_k) - \\mu(t) ]^2 }{ 2 \\mu(t)^2 (t-u_k) } \\right\\}\n\\]\nHere, \\(\\kappa\\) is the shape parameter (analogous to \\(\\theta_{p+1}\\) in Barbieri et al. 2005), which determines the variance and skewness of the interval distribution.\nThe conditional intensity is defined as the hazard rate:\n\\[\n\\lambda(t \\mid \\mathcal{H}_t) = \\frac{f(t \\mid u_k, \\mathbf{x}(t))}{1 - F(t \\mid u_k, \\mathbf{x}(t))}\n\\]\nThis function rises sharply as the time elapsed since the last beat \\(t - u_k\\) approaches the target mean \\(\\mu(t)\\), effectively representing the increasing probability of depolarization threshold crossing. Unlike Poisson intensities which are often flat or monotonic, the Inverse Gaussian hazard function naturally incorporates a refractory period (where \\(\\lambda \\approx 0\\) for small \\(t-u_k\\)) and a rapid rise, mirroring the biophysics of the cardiac cycle.\nThe code below visualizes this hazard function, demonstrating how a shift in the autonomic state (changing \\(\\mu(t)\\)) alters the probability profile of the next beat.\n\n\nCode\nplot_ig_hazard &lt;- function() {\n  # Define time axis (time since last beat)\n  tau &lt;- seq(0.01, 3.0, length.out = 500)\n  \n  # Helper to compute Hazard\n  calc_hazard &lt;- function(tau_vec, mu_val, lambda_scale) {\n    pdf_val &lt;- numeric(length(tau_vec))\n    cdf_val &lt;- numeric(length(tau_vec))\n    \n    # Calculate PDF and CDF for Inverse Gaussian\n    for(i in seq_along(tau_vec)) {\n      t &lt;- tau_vec[i]\n      # PDF\n      term1 &lt;- sqrt(lambda_scale / (2 * pi * t^3))\n      term2 &lt;- exp(-lambda_scale * (t - mu_val)^2 / (2 * mu_val^2 * t))\n      pdf_val[i] &lt;- term1 * term2\n      \n      # CDF\n      z1 &lt;- sqrt(lambda_scale/t) * (t/mu_val - 1)\n      z2 &lt;- -sqrt(lambda_scale/t) * (t/mu_val + 1)\n      cdf_val[i] &lt;- pnorm(z1) + exp(2*lambda_scale/mu_val) * pnorm(z2)\n    }\n    \n    # Hazard = PDF / Survival\n    survival &lt;- 1 - cdf_val\n    survival[survival &lt; 1e-6] &lt;- 1e-6 # Numerical floor\n    return(pdf_val / survival)\n  }\n  \n  # Scenario 1: Baseline (Mean Interval = 0.8s, approx 75 BPM)\n  h_base &lt;- calc_hazard(tau, mu_val = 0.8, lambda_scale = 15)\n  \n  # Scenario 2: Sympathetic Activation (Mean Interval = 0.5s, 120 BPM)\n  h_sym &lt;- calc_hazard(tau, mu_val = 0.5, lambda_scale = 15)\n  \n  par(mar = c(5, 5, 2, 2))\n  plot(tau, h_base, type = 'l', lwd = 3, col = \"black\", ylim = c(0, 40),\n       xlab = \"Time since last beat (s)\", ylab = expression(lambda(t * \"|\" * H[t])),\n       main = \"Conditional Intensity Dynamics\", frame.plot = FALSE)\n  lines(tau, h_sym, lwd = 3, col = \"#D55E00\", lty = 2)\n  \n  legend(\"topleft\", legend = c(\"Baseline State\", \"Sympathetic State\"),\n         col = c(\"black\", \"#D55E00\"), lty = c(1, 2), lwd = 3, bty = \"n\")\n  grid(col = \"lightgray\")\n}\n\nplot_ig_hazard()\n\n\n\n\n\n\n\n\nFigure 2: The Inverse Gaussian Hazard Function. The solid line represents the conditional intensity under baseline conditions. The dashed line shows the effect of sympathetic activation, which shortens the mean interval mu(t) and shifts the steep rising phase of the intensity to the left, increasing the probability of an earlier beat."
  }
]