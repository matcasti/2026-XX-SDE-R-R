---
title: "Just check the PULSE"
subtitle: "A point-process framework for estimating latent sympathovagal dynamics from R–R intervals"
author: "Matías Castillo-Aguilar"
---

# Methods

This methods section provides a detailed and formal description of the complete data generation process, the principal mechanistic components of the modeling framework, and the parameterization with explicit physiological interpretation for each parameter. The mathematical description emphasizes a continuous-time representation suitable for event-driven cardiac data (R–R intervals), and describes how latent autonomic processes and observation mechanisms combine to produce observable heartbeat sequences. The presentation is structured into three substantive parts that correspond to the requested focus: first, the formal generative model for data; second, an exposition of the model's internal mechanisms and their interactions; and third, a comprehensive parameter-by-parameter description linking model quantities to physiological constructs and their operational meaning for inference and biomarker construction.

## Formal description of the complete data generation process

Let $\{t_i\}_{i=1}^{N}$ denote the observed heartbeat event times recorded over an observation window $[0,T]$. The generative model treats heartbeat occurrences as a conditionally inhomogeneous point process whose conditional intensity $\lambda(t\mid\mathcal{H}_t)$ depends on latent autonomic state processes, exogenous inputs, a slowly varying tonic component, and a short-term history dependence term. The generative model is hierarchical: latent continuous-time stochastic processes generate time-varying modulatory signals that determine the conditional hazard; the hazard governs the random occurrence of events; observed R–R intervals are the inter-event times $\Delta t_i = t_i - t_{i-1}$ produced by the point process; a separate censoring and artifact process may remove or distort certain events to reflect measurement realities.

The conditional intensity is specified on the log scale to ensure positivity and to enable additive decomposition of effects. Formally,

$$
\log\lambda(t\mid\mathcal{H}_t) = \mu + \alpha_{p}\,p(t) - \alpha_{s}\,s(t) + \gamma\,T_{\mathrm{circ}}(t) + \beta\,u(t) + H(\mathcal{H}_t),
$$

where $p(t)$ and $s(t)$ are latent processes representing parasympathetic and sympathetic activity respectively, $T_{\mathrm{circ}}(t)$ is a slow tonic or circadian component, $u(t)$ is a known deterministic exogenous input (for example an indicator of exercise), and $H(\mathcal{H}_t)$ denotes a causal history-dependent term. The signs in the expression are chosen to reflect the canonical physiological directions: elevations in $p(t)$ lengthen interbeat intervals (reduce instantaneous heart rate) so that $\alpha_{p}$ acts positively on log intensity in conjunction with a negative sign on the time axis mapping; elevations in $s(t)$ shorten interbeat intervals (increase instantaneous heart rate), captured through the negative sign before $\alpha_{s}$. The baseline level $\mu$ provides the log-hazard in the absence of modulatory inputs and history effects.

The latent autonomic processes evolve under linear stochastic differential equations (SDEs) with coupling terms that permit directed influences between the branches. The SDE formulation preserves the continuous-time nature of underlying physiology and provides a natural way to represent differences in intrinsic time scales and stochastic fluctuation magnitudes. The SDE system is given by

$$
\begin{aligned}
dp(t) &= -a_{p}\,p(t)\,dt + b_{ps}\,s(t)\,dt + c_{p}\,u(t)\,dt + \sigma_{p}\,dW_{p}(t), \\
ds(t) &= -a_{s}\,s(t)\,dt + b_{sp}\,p(t)\,dt + c_{s}\,u(t)\,dt + \sigma_{s}\,dW_{s}(t),
\end{aligned}
$$

with $a_{p}>0$ and $a_{s}>0$ being decay rates, $b_{ps}$ and $b_{sp}$ quantifying cross-branch coupling, $c_{p}$ and $c_{s}$ representing exogenous input gains, and $\sigma_{p}\,dW_{p}$, $\sigma_{s}\,dW_{s}$ representing independent (or, optionally, correlated) Wiener-driven diffusion terms. Initial conditions $p(0)$ and $s(0)$ are drawn from a prescribed prior distribution, typically Gaussian with mean reflecting baseline autonomic tone and variance reflecting prior uncertainty. The tonic component $T_{\mathrm{circ}}(t)$ can be represented either deterministically, for example by a sinusoid $A_{\mathrm{circ}}\sin(2\pi t/24 + \phi)$ when diurnal modulation is relevant, or as a low-frequency stochastic drift term when long recordings are considered without explicit periodic structure.

The observation process is linked to the point process likelihood. Given the conditional intensity $\lambda(t)$, the joint density (or likelihood) for event times under the realization of the intensity over $[0,T]$ is

$$
\mathcal{L}(\{t_i\}\mid \theta, p(\cdot), s(\cdot)) = \left[\prod_{i=1}^{N}\lambda(t_i\mid\mathcal{H}_{t_i})\right]\exp\left(-\int_{0}^{T}\lambda(u\mid\mathcal{H}_u)\,du\right),
$$

where $\theta$ denotes the collection of static parameters. In practice, the history term $H(\mathcal{H}_t)$ depends on recent inter-event times and can be implemented as a short memory kernel, such as an exponential kernel applied to previous events or as an autoregressive function of the most recent interbeat interval; this term captures refractoriness, immediate beat-to-beat dependence (including residual respiratory sinus arrhythmia when explicit respiration measurements are absent), and detector-specific short-term structure.

Real recordings also contain artifacts and missingness. The model accommodates these realities by treating each observed event as potentially censored or corrupted through an auxiliary Bernoulli process that flags events removed due to ectopy, sensor dropout, or erroneous detections. When an event is identified as missing, the likelihood contribution for that interval is replaced by the corresponding survival term under the conditional intensity. The measurement process may also introduce timestamp jitter; small timestamp perturbation can be modeled as additive measurement noise on event times, though for high-quality electrocardiogram-based beat detection this term may be negligible. Where beat annotation uncertainty is substantial, explicit modeling of timestamp noise or probabilistic beat assignment should be included in the generative description.

Numerical implementation of the continuous-time generative model requires discretization for simulation and likelihood evaluation. The SDEs are discretized with an Euler–Maruyama or higher order scheme on a grid $\{t_k\}$ with step $\Delta t$ chosen to resolve the fastest physiological time constant. For each grid interval the latent state is propagated and the integral of the intensity is approximated by numerical quadrature, typically by summing the intensity evaluated at grid points multiplied by $\Delta t$ or by Simpson-type rules when greater accuracy is desired. Event generation under simulation is performed by thinning algorithms that sample candidate event times from an upper bound on the intensity and accept them with probability $\lambda(t)/\lambda_{\text{max}}$ to produce event sequences consistent with the instantaneous hazard. The complete data generation process therefore maps static parameters and stochastic latent trajectories to realizations of heartbeat times, subject to censoring and artifact processes that reflect the measurement environment.

## Main mechanisms of the model and inner components

The modeling framework comprises several interlocking mechanisms, each corresponding to a distinct physiological or statistical function. These mechanisms include the latent autonomic dynamics, the mapping from latent states to instantaneous hazard, the short-term history module, the tonic/circadian modulation, the exogenous input pathway, the stochastic fluctuation processes, and the observation/censoring process. The model is constructed so that each mechanism can be interpreted in physiological terms while remaining amenable to statistically consistent inference.

The latent autonomic dynamics mechanism is central to the model. Parasympathetic and sympathetic influences are represented as continuous-valued state variables $p(t)$ and $s(t)$. The linear drift structure $-a_{p}p(t)$ and $-a_{s}s(t)$ imposes a restoring or decay tendency, such that absent input the state relaxes exponentially toward zero with characteristic time constants $\tau_{p}=1/a_{p}$ and $\tau_{s}=1/a_{s}$. Coupling terms $b_{ps}\,s(t)$ and $b_{sp}\,p(t)$ introduce directed interactions in which the state of one branch influences the rate of change of the other. These coupling coefficients can represent physiologically plausible mechanisms such as reciprocal modulation where sympathetic activation produces vagal withdrawal with a certain delay and magnitude, or more complex facilitative or gating interactions. The exogenous input gains $c_{p}$ and $c_{s}$ route experimentally controlled perturbations (for example, onset of exercise) into changes in autonomic drive, with magnitudes representing the sensitivity of each branch to the perturbation. The diffusion terms, with scale parameters $\sigma_{p}$ and $\sigma_{s}$, provide a mechanism for endogenous fluctuation and unmodeled inputs, ensuring that latent trajectories are not strictly deterministic given initial conditions and inputs.

The mapping from latent autonomic state to instantaneous hazard is another core mechanism and is implemented through the log-linear observation link. The coefficients $\alpha_{p}$ and $\alpha_{s}$ provide the conversion from modulator units to log-intensity units; they determine how a given change in the latent variable affects the instantaneous propensity for the next heartbeat. This mapping embodies the physiological notion that vagal tone has a rapid and strong influence on beat timing while sympathetic tone modulates more slowly and affects baseline heart rate. Because the intensity is in exponential form, shifts in latent state result in multiplicative changes in instantaneous hazard and hence nonlinear effects on the distribution of interbeat intervals, an aspect that captures the non-Gaussian nature of beat-time variability.

The short-term history mechanism captures immediate past-dependent effects such as refractory behavior and high-frequency modulation due to respiration. Implementationally, this is realized by including a causal kernel applied to recent events or by including a parametric function of the last interbeat interval. The history kernel produces transient reductions or increases in hazard following an event; for example, an exponential kernel with negative amplitude enforces a short refractory period, reducing the probability of an immediate subsequent beat. The history term thus prevents the latent autonomic variables from attempting to explain phenomena that have inherently short memory and are better modeled as event-driven refractoriness, while also subsuming residual respiratory sinus arrhythmia when respiration is not separately measured.

The tonic or circadian mechanism provides low-frequency modulation of baseline susceptibility to beating and is particularly important for prolonged recordings. When present, a sinusoidal or low-frequency stochastic component modulates the baseline $\mu$ so that diurnal patterns in heart rate are represented. Parameterizing this slow component with amplitude and phase allows the model to separate day–night baseline shifts from short-term autonomic reactivity, thereby improving identification of the dynamic parameters of interest.

The observation and censoring mechanism accounts for how latent processes and the instantaneous hazard produce observed event times, and how measurement imperfections intervene. The point process law provides the probabilistic mapping, and the integral term in the likelihood captures the cumulative hazard over recording windows including periods with missing events. When artifacts are detected, the model treats intervals as censored and the corresponding likelihood terms are handled accordingly, preserving statistical coherence. The inclusion of a censoring mechanism is essential for real-world data where ectopic beats, sensor dropout, or annotation uncertainty are unavoidable.

These inner components are not independent; they interact in ways that shape identifiability and the dynamics of inferred trajectories. For instance, the history mechanism and the parasympathetic latent process operate on overlapping fast time scales. If the history term is omitted, the parasympathetic latent variable will attempt to explain refractory and respiratory effects, biasing the estimated vagal dynamics. Conversely, an overly aggressive history kernel can absorb genuine vagal reactivity. The coupling terms influence both the transient response to perturbations and the recovery dynamics; positive feedback can amplify transient responses while negative feedback can produce faster return to baseline. The diffusion terms introduce stochasticity that propagates through the mapping to intensity and affects interbeat time dispersion; larger diffusion impairs the precision with which deterministic parameter values can be recovered. The deterministic tonic term interacts with slow sympathetic fluctuations and can confound estimates of tonic sympathetic tone if not properly specified or allowed to vary flexibly.

Extensibility of the inner components permits the model to accommodate richer physiological hypotheses. Nonlinear drift functions may be used to capture saturating or rectified autonomic responses, state-dependent diffusion can represent heteroscedastic variability that increases with activity, and switching regimes may represent distinct autonomic operating modes such as sleep versus wake or rest versus heavy exercise. Each extension alters inference characteristics and should be justified by prior physiological knowledge and data richness.

## Model parameterization and physiological interpretation of each parameter

The model is parameterized by the collection $\theta$ comprising decay rates, coupling coefficients, input gains, observation gains, diffusion scales, baseline intensity parameters, history kernel parameters, tonic component parameters, and initial condition parameters. Each parameter is described here in terms of its mathematical role, physiological meaning, typical units or scales, typical plausible ranges, identifiability considerations, and practical reparameterizations used to aid inference.

The parasympathetic decay rate $a_{p}>0$ appears in the SDE drift $-a_{p}p(t)$. Mathematically it governs the exponential relaxation of $p(t)$ in the absence of inputs. Physiologically it represents the inverse of the characteristic vagal time constant, with $\tau_{p}=1/a_{p}$ corresponding to the typical duration over which vagally mediated adjustments to heart period decay. Typical values for $\tau_{p}$ are on the order of one to a few seconds in healthy adult humans under resting conditions; consequently $a_{p}$ is typically in the range of $0.2$ to $1.0$ s$^{-1}$, though exact values depend on scaling conventions for $p$. For identifiability it is often advantageous to adopt a prior that concentrates mass on short time constants while allowing variability across subjects. Reparameterization in terms of $\tau_{p}$ simplifies prior elicitation and interpretation.

The sympathetic decay rate $a_{s}>0$ plays an analogous mathematical role for $s(t)$ and physiologically corresponds to the inverse of the sympathetic time constant $\tau_{s}=1/a_{s}$. Sympathetic-mediated changes in heart period evolve more slowly than vagal effects; typical $\tau_{s}$ values are on the order of tens of seconds to several minutes, implying $a_{s}$ values in the approximate range $0.005$ to $0.05$ s$^{-1}$. Because sympathetic time scales can substantially exceed recording segment lengths, identifiability of $a_{s}$ improves with longer recordings or the presence of perturbations that elicit large sympathetic responses.

The coupling coefficients $b_{ps}$ and $b_{sp}$ determine directed influences between branches. The parameter $b_{ps}$ multiplies $s(t)$ in the equation for $dp(t)$ and thus quantifies how sympathetic activity drives change in parasympathetic activity; a negative sign would indicate sympathetic-driven vagal withdrawal if the modeled conventions produce such an effect. The parameter $b_{sp}$ quantifies parasympathetic influence on sympathetic dynamics. Physiologically, these coefficients capture interactions mediated by central autonomic networks and reflex arcs, and they provide a way to infer directionality and relative dominance between branches. The natural units are inverse time (s$^{-1}$); magnitudes are typically small relative to self-decay rates, and their sign and scale require careful prior specification. Identifiability of coupling terms benefits from experimental perturbations and from asymmetries in time constants; in the absence of informative inputs or prolonged recordings, coupling estimates can be poorly constrained and highly correlated with other parameters.

The exogenous input gains $c_{p}$ and $c_{s}$ convert a known input signal $u(t)$ into instantaneous influence on the latent processes. For an exercise indicator $u(t)$ that takes values 0 (rest) or 1 (exercise), $c_{s}$ represents the increase in sympathetic drive induced by exercise per unit of $u$, while $c_{p}$ represents the corresponding change to parasympathetic drive. Physiologically, exercise typically produces $c_{s}>0$ and $c_{p}<0$ when $p$ is defined in units such that increases reflect vagal activity. These gains determine the amplitude of the autonomic response to controlled provocations and are directly interpretable as reactivity indices in biomarker construction. Units follow the state scaling; typical magnitudes should be set relative to the scaling of $p$ and $s$, and priors should permit both excitatory and inhibitory effects.

The diffusion coefficients $\sigma_{p}\ge 0$ and $\sigma_{s}\ge 0$ scale the Wiener-driven noise terms and therefore determine the magnitude of stochastic fluctuations in autonomic drive. Mathematically these parameters control variance accumulation over time and thus the ensemble dispersion of latent trajectories. Physiologically larger diffusion reflects greater variability due to unmodeled physiological inputs, central noise, or other modulatory systems. Identifiability of diffusion requires sufficient temporal information to separate process noise from observation-driven variability; over short recordings diffusion and observation link gain parameters can be confounded. Where diffusion is inferred, informative priors or structural constraints can improve robustness.

The observation gains $\alpha_{p}>0$ and $\alpha_{s}>0$ convert latent autonomic states into contributions to the log-intensity of the point process. The product $\alpha_{p}p(t)$ specifies how vagal variation translates to instantaneous changes in propensity for a heartbeat; equivalently, the mapping determines the sensitivity of interbeat intervals to autonomic fluctuations. Physiologically vagal influences tend to have larger per-unit effects on beat timing compared with sympathetic influences on short time scales; this asymmetry may be encoded via prior expectations on $\alpha_{p}$ and $\alpha_{s}$. Estimation of these gains is crucial for mapping latent-unit fluctuations into interpretable heart-rate changes, and rescaling latent state variables to make $\alpha$'s near unity can simplify interpretation and prior elicitation.

The baseline log-intensity $\mu$ sets the nominal heart-beat propensity in the absence of modulatory effects and history. It is closely related to the mean heart rate, with the mean interbeat interval approximately given by the inverse of the expected hazard under stationarity. The prior for $\mu$ can be centered on the empirical log-rate estimated from observed data, and adjustments to $\mu$ interact with observation gains in determining overall heart-rate level; hence scaling identifiability issues between $\mu$ and $\alpha$ parameters must be monitored.

The history kernel parameters control the shape and amplitude of the short-term memory term $H(\mathcal{H}_t)$. A canonical parametrization is $H(\mathcal{H}_t) = \int_{0}^{\infty} h(\tau) dN(t-\tau)$ with $h(\tau)=A_{\mathrm{hist}}\exp(-\tau/\kappa_{\mathrm{hist}})$, where $A_{\mathrm{hist}}$ is the kernel amplitude and $\kappa_{\mathrm{hist}}$ the decay time. The amplitude $A_{\mathrm{hist}}$ typically assumes negative values to represent refractory suppression immediately following an event, and the decay parameter $\kappa_{\mathrm{hist}}$ is on the order of a few hundred milliseconds to a few seconds. These parameters are directly interpretable in terms of immediate electrophysiological recovery and short-term modulation such as RSA when respiration is not otherwise modeled. Identifiability of history parameters is generally good when many beats are observed and the event-generating process is active across short time scales.

The tonic/circadian parameters include amplitude $A_{\mathrm{circ}}$, period (often fixed at 24 hours), and phase $\phi$. The amplitude quantifies the range of diurnal modulation in log-intensity and is useful for separating slowly varying baseline shifts from dynamic autonomic responses. When long-duration recordings are available, accurate estimation of tonic parameters improves separation of slow sympathetic dynamics from diurnal effects.

Initial state parameters specify the prior mean and covariance for $p(0)$ and $s(0)$. The prior mean may be set to reflect expected baseline autonomic tone; prior covariance encodes uncertainty and aids numerical stability during inference. Informative priors on initial states can aid identifiability in short segments where latent dynamics have insufficient time to fully express.

Finally, parameters governing the censoring or artifact process (for example the rate of ectopy or probability of misdetection) describe the measurement environment. These parameters influence the likelihood by dictating which intervals are modeled as observed versus censored and should be chosen based on annotation protocols or estimated jointly when annotation uncertainty is present.

Parameter transformations and constraints facilitate numerical inference. Positivity constraints for decay rates and diffusion scales are implemented via log or softplus transforms; time-constant parametrization $ \tau = 1/a $ provides intuitive priors; rescaling of latent states to place observation gains near unity reduces posterior correlation between gains and baseline $\mu$. Hierarchical parameterizations that share hyperpriors across subjects allow pooling when multiple recordings are analyzed, improving estimation of parameters that are weakly identified within individual short recordings.

In summary, the model parameters each have a clear mathematical role within the SDE-based latent dynamics and point-process observation framework and a direct or interpretable physiological counterpart. The decay rates correspond to characteristic autonomic time constants, coupling coefficients express directed inter-branch interaction, input gains quantify responsiveness to perturbations, observation gains convert latent fluctuations to heart-rate effects, diffusion parameters characterize endogenous variability, history parameters capture event-driven short-term structure, tonic parameters represent slow baseline modulation, and censoring parameters model measurement realities. Careful prior elicitation, thoughtful reparameterization, and judicious use of experimental perturbations are essential to render these parameters identifiable and to translate them into reliable biomarkers of resilience and adaptation.
